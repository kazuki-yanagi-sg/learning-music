# Planning.md - アニソン作曲学習カリキュラム

## ゴール

**音楽理論ゼロ → オリジナルアニソン 1 曲完成**

---

## 演習設計方針

**数学的アプローチ: 演習量で定着させる**

### 各レッスンの構成

```
1. 理論説明（なぜそうなるか）
2. 音で確認（実際に聴く）
3. 基本演習（3-5問）: 理論の直接適用
4. 応用演習（3-5問）: 少しひねった問題
5. 実践演習（1-2問）: 実際に作ってみる
```

### 演習タイプ

| タイプ       | 例                                          |
| ------------ | ------------------------------------------- |
| **認識問題** | 「この音程は何半音？」→ 選択式              |
| **構築問題** | 「ルート 5 でメジャーコードを作れ」→ 入力式 |
| **聴音問題** | 「この響きはメジャー？マイナー？」→ 選択式  |
| **分析問題** | 「この進行の機能を答えよ」→ 記述式          |
| **作成問題** | 「4 小節のメロディを作れ」→ 自由入力        |

### 反復の仕組み

- 間違えた問題は後で再出題
- ランダム出題モードあり
- 各 Phase の総復習テスト

---

## Phase 1: 音の基礎

### Lesson 1.1: 音は数字だ

**学ぶこと:**

- 12 音の世界（0-11, mod 12）
- オクターブの概念（12 足すと 1 オクターブ上）
- MIDI ノートナンバー

**課題:**

- 任意の音を数字で入力できる
- オクターブ違いの同じ音を認識できる

### Lesson 1.2: 2 つの音の距離（インターバル）

**学ぶこと:**

- インターバル = 2 音の差（引き算）
- 各インターバルの響きと感情

| 距離 | 名前            | 響き                 |
| ---- | --------------- | -------------------- |
| 0    | ユニゾン        | 同じ音               |
| 1    | 短 2 度         | 不協和、緊張         |
| 2    | 長 2 度         | やや緊張             |
| 3    | 短 3 度         | 暗い、切ない         |
| 4    | 長 3 度         | 明るい               |
| 5    | 完全 4 度       | 浮遊感               |
| 6    | 増 4 度/減 5 度 | 不安定（悪魔の音程） |
| 7    | 完全 5 度       | 安定、力強い         |
| 8    | 短 6 度         | 神秘的               |
| 9    | 長 6 度         | 温かい               |
| 10   | 短 7 度         | ブルージー           |
| 11   | 長 7 度         | おしゃれ、都会的     |

**課題:**

- 2 音を聴いて距離を当てる
- 指定された感情の距離を入力する

---

## Phase 2: 和声の基礎

### Lesson 2.1: コード = 音の塊

**学ぶこと:**

- コード = 複数の音を同時に鳴らす
- メジャーコード: `[0, 4, 7]` → 明るい
- マイナーコード: `[0, 3, 7]` → 暗い

**課題:**

- ルート音を指定してメジャー/マイナーを作る
- コードを聴いてメジャーかマイナーか判定

### Lesson 2.2: 7th コード

**学ぶこと:**

- メジャー 7th: `[0, 4, 7, 11]` → おしゃれ
- マイナー 7th: `[0, 3, 7, 10]` → 切ないおしゃれ
- ドミナント 7th: `[0, 4, 7, 10]` → 緊張 → 解決したい

**アニソンでの使われ方:**

- A メロでマイナー 7th → 物語の始まり
- サビ前でドミナント 7th → 盛り上がりへの期待

### Lesson 2.3: ダイアトニックコード

**学ぶこと:**

- キー（調）= 使う音の集合
- メジャーキー: `[0, 2, 4, 5, 7, 9, 11]`（全全半全全全半）
- 7 つのダイアトニックコード

| 度数 | 構成  | 機能               |
| ---- | ----- | ------------------ |
| I    | Major | トニック（安定）   |
| ii   | minor | サブドミナント     |
| iii  | minor | トニック代理       |
| IV   | Major | サブドミナント     |
| V    | Major | ドミナント（緊張） |
| vi   | minor | トニック代理       |
| vii° | dim   | ドミナント代理     |

---

## Phase 3: コード進行

### Lesson 3.1: 機能和声

**学ぶこと:**

- トニック（T）: 安定、家
- サブドミナント（SD）: 展開、旅立ち
- ドミナント（D）: 緊張、家に帰りたい

**基本の流れ:**

```
T → SD → D → T（循環）
```

### Lesson 3.2: アニソン頻出進行

**王道進行:** `IV → V → iii → vi`

- 例: 「残酷な天使のテーゼ」
- 感情: 壮大、感動的

**小室進行:** `vi → IV → V → I`

- 例: 多くの 90 年代アニソン
- 感情: 切なくも力強い

**カノン進行:** `I → V → vi → iii → IV → I → IV → V`

- 例: パッヘルベルのカノン派生
- 感情: 安定、王道

**Just the Two of Us 進行:** `IVM7 → III7 → vi`

- 例: 都会的なアニソン
- 感情: おしゃれ、夜の街

**課題:**

- 各進行を打ち込んで響きを確認
- 好きなアニソンの進行を分析

### Lesson 3.3: 借用和音とテンション

**学ぶこと:**

- セカンダリードミナント: V7/vi など
- サブドミナントマイナー: IVm
- 転調への橋渡し

---

## Phase 4: メロディ

### Lesson 4.1: スケール

**学ぶこと:**

- メジャースケール: `[0, 2, 4, 5, 7, 9, 11]`
- マイナースケール: `[0, 2, 3, 5, 7, 8, 10]`
- ペンタトニック: `[0, 2, 4, 7, 9]`（ハズレなし）

**アニソンのコツ:**

- サビはペンタトニック寄りでキャッチー
- A メロはスケール全体を使って物語性

### Lesson 4.2: モチーフと展開

**学ぶこと:**

- モチーフ = 短いフレーズ（2-4 音）
- 反復: 同じモチーフを繰り返す
- 変形: 高さを変える、リズムを変える

**課題:**

- 4 音のモチーフを作る
- そのモチーフを展開して 8 小節のメロディを作る

### Lesson 4.3: コードトーンとテンション

**学ぶこと:**

- コードトーン: コード構成音に着地 → 安定
- テンション: コード外の音 → 緊張感

**アニソンのコツ:**

- サビの頭はコードトーン（わかりやすく）
- B メロはテンション多め（盛り上げ準備）

---

## Phase 5: リズム

### Lesson 5.1: 拍子と BPM

**学ぶこと:**

- 4/4 拍子（ほとんどのアニソン）
- BPM 140-180（アップテンポ系）
- BPM 80-120（バラード系）

### Lesson 5.2: リズムパターン

**学ぶこと:**

- 8 ビート（基本）
- 16 ビート（ノリが良い）
- シンコペーション（食い）

**アニソンのコツ:**

- サビはシンプルなリズムで歌いやすく
- A メロはシンコペで躍動感

---

## Phase 6: 曲構成

### Lesson 6.1: アニソンの設計図

**基本構成:**

```
イントロ（4-8小節）: ←【解析可能】
  ↓
Aメロ（8-16小節）: 物語の始まり、静か ←【解析可能】
  ↓
Bメロ（8小節）: 盛り上げ、サビへの助走 ←【解析可能】
  ↓
サビ（16小節）: 最高潮、キャッチー ←【解析可能】
  ↓
間奏（4-8小節）: ←【解析可能】
  ↓
2番（Aメロ→Bメロ→サビ）
  ↓
Cメロ/落ちサビ（8小節）: 静かに、転調もあり ←【解析可能】
  ↓
ラスサビ（16小節）: 最大の盛り上がり ←【解析可能】
  ↓
アウトロ（4-8小節）: ←【解析可能】
```

**✓ フル構成解析が可能（YouTube + yt-dlp + Magenta）**

**課題:**

- アニソン 10 曲の構成を調べて、共通パターンを見つける
- 各セクションの小節数を表にまとめる

### Lesson 6.2: 各セクションの作り方

**A メロ:**

- 静かめ、コードはシンプル
- メロディは語るように

**B メロ:**

- 徐々に盛り上げ
- サブドミナント多め

**サビ:**

- 一番高い音域
- キャッチーなメロディ
- 王道進行

**🔍 参照曲で確認（フル構成解析可能）:**

1. 好きなアニソンを検索・解析
2. 各セクションのコード進行を確認
3. 各セクションのメロディの音域を確認
4. セクション間の遷移を分析

**課題:**

- 参照曲をフル解析し、各セクションの特徴を言語化する
- A メロ/B メロ/サビの違いを分析
- 自分の曲の設計図を作る（各セクションの小節数を決める）

---

## Phase 7: 実践

### Lesson 7.1: 8 小節のサビを作る

**課題:**

- 王道進行（IV→V→iii→vi）を使用
- キャッチーなメロディを乗せる

### Lesson 7.2: A メロ →B メロ → サビを作る

**課題:**

- 32 小節の流れを作る
- 各セクションのコントラストを意識

### Lesson 7.3: 1 曲完成させる

**課題:**

- フル構成（イントロ〜アウトロ）を作成
- 転調を 1 箇所入れる

---

## Phase 8: 統合（4 トラック合成）

**この Phase の特徴:**

- 参照曲をフル解析して学ぶ
- YouTube 検索 → フル解析 → 自分の曲に適用 のサイクル
- 耳コピ練習と作曲スキルを同時に習得

**✓ フル構成解析が可能（YouTube + yt-dlp + Magenta）:**

```
参照曲で解析可能:
  ✓ イントロ〜アウトロまで全セクション
  ✓ 各セクションのコード進行・楽器配置・リズム
  ✓ セクション間の遷移
```

### Lesson 8.1: 各楽器の役割を理解

**学ぶこと:**

- ドラム: リズム/テンポの土台、曲の骨格
- ベース: ルート音でコード進行を支える、グルーヴ
- キーボード: 和音の響き、メロディの補強
- ギター: コードボイシング、装飾、エネルギー

**アニソンでの典型的な役割分担:**
| セクション | ドラム | ベース | キーボード | ギター |
|-----------|--------|--------|------------|--------|
| A メロ | 軽め/なし | ルートのみ | パッド系 | アルペジオ |
| B メロ | 8 ビート | 動きを増やす | コード弾き | バッキング |
| サビ | フル | オクターブ | 厚いボイシング | パワーコード |

**🔍 参照曲で確認（フル構成解析可能）:**

1. 好きなアニソンを検索
2. フル構成を解析
3. 各セクションで「どの楽器が何をしているか」を書き出す
4. セクションごとの楽器配置の違いを分析

**課題:**

- 参照曲の各セクションの楽器の役割を分析レポートにまとめる
- 同じコード進行を各楽器で弾いてみる

### Lesson 8.2: リズム隊（ドラム + ベース）

**学ぶこと:**

- ドラムとベースの関係性
- キック（バスドラム）とベースの同期
- グルーヴの作り方

**基本パターン:**

```
ドラム: キック on 1, 3 / スネア on 2, 4
ベース: キックと同じタイミングでルート音
```

**🔍 参照曲で確認（フル構成解析可能）:**

1. 参照曲をフル解析
2. 各セクションのドラムパターンを聴き取る（キック/スネアの位置）
3. Aメロ/Bメロ/サビでのベースの変化を確認
4. 同じパターンを自分で打ち込んでみる

**課題:**

- 参照曲の各セクションのリズム隊を耳コピ
- セクションごとのリズムの変化を分析
- 2 トラックで再生して一体感を確認

### Lesson 8.3: 土台 + メロディ（リズム隊 + キーボード）

**学ぶこと:**

- リズム隊の上にキーボードを乗せる
- コードボイシングの基本（転回形）
- 音域の棲み分け

**音域の原則:**

```
キーボード: 中音域〜高音域（メロディと被らない）
ベース:     低音域（ルート中心）
ドラム:     全帯域だが低音（キック）と高音（ハイハット）
```

**🔍 参照曲で確認（フル構成解析可能）:**

1. 参照曲の各セクションでキーボード/シンセの音域を確認
2. ベースとの音域の棲み分けを確認
3. セクションごとのコード転回形の変化を分析
4. 同様の音域配置を自分の曲に適用

**課題:**

- 参照曲の各セクションのキーボードパートを耳コピ
- Lesson 8.2 で作ったリズム隊にキーボードを追加
- セクションごとの音域バランスの変化を再現

### Lesson 8.4: フルバンド（3 トラック + ギター）

**学ぶこと:**

- ギターの役割（補強 or 対比）
- キーボードとギターの棲み分け
- ダブリング（同じフレーズを 2 楽器で）

**アレンジパターン:**

```
パターンA: キーボードがコード、ギターがアルペジオ
パターンB: ギターがパワーコード、キーボードがパッド
パターンC: 両方がユニゾン（厚みを出す）
```

**🔍 参照曲で確認（フル構成解析可能）:**

1. 参照曲の各セクションがパターン A/B/C のどれに近いか判定
2. キーボードとギターのセクションごとの棲み分けを分析
3. ダブリングがどのセクションで使われているか確認
4. 自分の曲に同じパターンを適用

**課題:**

- 参照曲の各セクションのギターパートを耳コピ
- セクションごとのキーボードとギターの関係性を分析
- 4 トラックで再生して全体のバランスを確認

### Lesson 8.5: セクション別アレンジ

**学ぶこと:**

- セクションごとの楽器配置
- 「引き算」の重要性（全部鳴らさない）
- ダイナミクス（強弱）の設計

**典型的な楽器配置:**

```
イントロ:   ギターリフ or キーボードのみ
Aメロ:     ドラム軽め + ベース + キーボード（ギターなし）
Bメロ:     全楽器（控えめに）
サビ:      全楽器（フルパワー）
落ちサビ:  キーボードのみ or アコギのみ
ラスサビ:  全楽器（最大）
アウトロ:  イントロと対応させる
```

**🔍 参照曲で確認（フル構成解析可能）:**

1. 参照曲の各セクションの楽器配置を確認
2. セクション間での楽器の追加/削除を分析
3. ダイナミクス（強弱）の変化を確認
4. 「引き算」がどのセクションで使われているか分析

**課題:**

- 参照曲の全セクションの楽器配置を分析
- 自分の曲の A メロ →B メロ → サビで楽器配置を設計
- 参照曲と同様のダイナミクス変化を再現

### Lesson 8.6: 4 トラックでサビを完成

**🔍 参照曲で確認（フル構成解析可能）:**

1. 作りたい曲に近いアニソンを検索
2. サビの 4 トラック構成を完全に分析
3. 「このサビみたいにしたい」を明確化

**課題:**

- Phase 7 で作ったサビのメロディを使用
- 参照曲のサビを手本に 4 トラックを構築
- ドラム → ベース → キーボード → ギターの順で構築
- 参照曲のサビと聴き比べて調整

**チェックリスト:**

- [ ] ドラムがテンポを明確に刻んでいる
- [ ] ベースがコード進行を支えている
- [ ] キーボードが和音の響きを出している
- [ ] ギターがエネルギーを加えている
- [ ] 参照曲のサビと同等のエネルギー感がある
- [ ] 全体で聴いてメロディが埋もれていない

### Lesson 8.7: フル構成を 4 トラックで完成

**🔍 参照曲で確認（フル構成解析可能）:**

1. 参照曲のフル構成を解析
2. 各セクションの楽器配置・コード進行を確認
3. セクション間の遷移を分析

**課題:**

- 参照曲のフル構成を手本に 4 トラックを構築
- イントロ → A メロ → B メロ → サビ → ... → アウトロ
- 各セクションの楽器配置を参照曲に合わせる
- セクション間の遷移を自然に

**最終チェックリスト:**

- [ ] イントロで曲の雰囲気が伝わる
- [ ] A メロは控えめに始まっている（サビより楽器少なめ）
- [ ] B メロでサビへの期待感がある
- [ ] サビが一番盛り上がっている（参照曲と同等）
- [ ] 落ちサビ → ラスサビの落差がある
- [ ] アウトロで自然に終わる
- [ ] 1 分 30 秒以上ある

---

## 実装順序

```
依存関係:
  Step 1-3 → Step 4 → Step 5 → Step 6 → Step 7

  ※ Step 4（楽曲解析）は Step 6（Phase 8）の前提条件
  ※ Phase 8 は「参照曲で確認」機能を使用するため
```

### Step 1: Core（必須機能）

1. [x] ピアノロール（音の入力）
2. [x] 音の再生エンジン
3. [x] 理論解説パネル

### Step 2: Lessons（学習機能）

4. [x] レッスン表示システム
5. [x] Phase 1-2 のレッスン実装
6. [ ] 練習問題システム

### Step 3: Analysis（解析機能）

7. [x] コード認識
8. [x] 進行パターン検出
9. [x] リアルタイム解説

### Step 4: 楽曲解析（必須・Phase 8 の前提）

10. [ ] YouTube Data API v3 連携（曲検索、URL 取得）
11. [ ] yt-dlp 連携（MP3 ダウンロード）
12. [ ] Magenta 連携（音声 → MIDI 変換）
13. [ ] コード進行認識（tonaljs）
14. [ ] 楽器パート分離（可能な範囲で）
15. [ ] 解説生成（Gemini）
16. [ ] 「この曲と同じ進行を使ってみよう」機能
17. [ ] 参照曲の保存・比較機能

### Step 5: Phase 3-7 実装

17. [ ] Phase 3: コード進行
18. [ ] Phase 4: メロディ
19. [ ] Phase 5: リズム
20. [ ] Phase 6: 曲構成
21. [ ] Phase 7: 実践（1 トラック）

### Step 6: Phase 8 実装（4 トラック統合）

※ Step 4（楽曲解析）完了が前提 22. [ ] 4 トラック UI（ドラム/ベース/キーボード/ギター） 23. [ ] 各トラック用音源エンジン 24. [ ] 楽器別アドバイザー（Gemini 連携） 25. [ ] Lesson 8.1-8.7 実装 26. [ ] 参照曲との比較表示機能 27. [ ] 耳コピ支援機能（参照曲のパートを聴き分ける）

### Step 7: Polish（仕上げ）

28. [ ] 進捗管理
29. [ ] 作品保存/書き出し（4 トラック MIDI/音声）
30. [ ] 参照曲分析の履歴保存
